---
/**
 * ServiceAreas Section Component
 * ==============================
 * Display service area cities with map placeholder
 */

import Icon from '@/components/ui/Icon.astro';
import Button from '@/components/ui/Button.astro';
import { cities, business } from '@/data/site';

interface Props {
  class?: string;
  title?: string;
  subtitle?: string;
  variant?: 'default' | 'compact' | 'grid';
  showMap?: boolean;
  limit?: number;
}

const {
  class: className,
  title = 'Proudly Serving North San Diego County',
  subtitle = 'From our Carlsbad headquarters, we provide fast emergency response throughout the region. Our local presence means we can be on-site quickly when you need us most.',
  variant = 'default',
  showMap = true,
  limit,
} = Astro.props;

const displayCities = limit ? cities.slice(0, limit) : cities;

// Group cities by tier for visual hierarchy
const tier1Cities = displayCities.filter(c => c.tier === 1);
const tier2Cities = displayCities.filter(c => c.tier === 2);
const tier3Cities = displayCities.filter(c => c.tier === 3);
---

<section class:list={['service-areas section bg-white', className]}>
  <div class="container">
    {variant === 'grid' ? (
      <!-- Grid variant - just the cities -->
      <div class="text-center max-w-3xl mx-auto mb-10">
        <h2 class="font-display text-display-lg text-brand-black mb-4">{title}</h2>
        <p class="text-body-lg text-brand-gray">{subtitle}</p>
      </div>
      
      <div class="grid grid-cols-2 sm:grid-cols-3 md:grid-cols-4 gap-4">
        {displayCities.map((city) => (
          <a 
            href={`/service-area/${city.slug}/`}
            class="group flex items-center gap-3 p-4 bg-white rounded-xl border border-brand-cream-300 hover:border-brand-orange hover:shadow-card transition-all"
          >
            <Icon name="map-pin" size="md" class="text-brand-orange flex-shrink-0" />
            <span class="font-medium text-brand-black group-hover:text-brand-orange transition-colors">
              {city.name}
            </span>
          </a>
        ))}
      </div>
    ) : (
      <!-- Default variant with map -->
      <div class="grid lg:grid-cols-2 gap-12 items-center">
        <!-- Content Side -->
        <div>
          <div class="inline-flex items-center gap-2 bg-brand-orange-100 text-brand-orange px-4 py-2 rounded-full text-body-sm font-semibold mb-4">
            <Icon name="map-pin" size="sm" />
            Local Service
          </div>
          
          <h2 class="font-display text-display-lg text-brand-black mb-4">
            {title}
          </h2>
          
          <p class="text-body-lg text-brand-gray mb-8">
            {subtitle}
          </p>
          
          <!-- City List by Tier -->
          <div class="space-y-6 mb-8">
            {tier1Cities.length > 0 && (
              <div>
                <h3 class="text-body-sm font-semibold text-brand-orange uppercase tracking-wider mb-3">
                  Primary Service Area
                </h3>
                <div class="grid grid-cols-2 gap-3">
                  {tier1Cities.map((city) => (
                    <a 
                      href={`/service-area/${city.slug}/`}
                      class="flex items-center gap-2 text-brand-black hover:text-brand-orange transition-colors font-medium"
                    >
                      <Icon name="check-circle" size="sm" class="text-brand-orange" />
                      {city.name}
                    </a>
                  ))}
                </div>
              </div>
            )}
            
            {tier2Cities.length > 0 && (
              <div>
                <h3 class="text-body-sm font-semibold text-brand-gray uppercase tracking-wider mb-3">
                  Extended Service Area
                </h3>
                <div class="grid grid-cols-2 gap-3">
                  {tier2Cities.map((city) => (
                    <a 
                      href={`/service-area/${city.slug}/`}
                      class="flex items-center gap-2 text-brand-black hover:text-brand-orange transition-colors"
                    >
                      <Icon name="map-pin" size="sm" class="text-brand-gray" />
                      {city.name}
                    </a>
                  ))}
                </div>
              </div>
            )}
            
            {tier3Cities.length > 0 && (
              <div class="grid grid-cols-2 gap-3">
                {tier3Cities.map((city) => (
                  <a 
                    href={`/service-area/${city.slug}/`}
                    class="flex items-center gap-2 text-brand-gray hover:text-brand-orange transition-colors"
                  >
                    <Icon name="map-pin" size="sm" class="text-brand-gray-light" />
                    {city.name}
                  </a>
                ))}
              </div>
            )}
          </div>
          
          <div class="flex flex-wrap gap-4">
            <Button href="/service-area/" variant="primary">
              View All Service Areas
            </Button>
            <Button href={`tel:${business.phone}`} variant="outline">
              <Icon name="phone" size="sm" />
              Call for Service
            </Button>
          </div>
        </div>
        
        <!-- Map Side -->
        {showMap && (
          <div class="relative">
            <!-- Map placeholder - would be replaced with actual map component -->
            <div class="aspect-square bg-brand-cream-200 rounded-2xl overflow-hidden shadow-card relative">
              <!-- Placeholder map background -->
              <div class="absolute inset-0 bg-gradient-to-br from-brand-cream-300 to-brand-cream-200">
                <!-- Grid lines for map effect -->
                <div class="absolute inset-0" style="background-image: linear-gradient(to right, rgba(0,0,0,0.03) 1px, transparent 1px), linear-gradient(to bottom, rgba(0,0,0,0.03) 1px, transparent 1px); background-size: 20px 20px;"></div>
              </div>
              
              <!-- City markers -->
              <div class="absolute inset-0 p-8">
                <!-- Carlsbad - Center -->
                <div class="absolute top-1/2 left-1/2 -translate-x-1/2 -translate-y-1/2 z-10">
                  <div class="relative">
                    <div class="absolute -inset-4 bg-brand-orange/20 rounded-full animate-ping"></div>
                    <div class="relative bg-brand-orange text-white px-3 py-1.5 rounded-lg shadow-lg flex items-center gap-2 whitespace-nowrap">
                      <Icon name="home" size="sm" />
                      <span class="font-semibold text-sm">Carlsbad HQ</span>
                    </div>
                  </div>
                </div>
                
                <!-- Oceanside - Top -->
                <div class="absolute top-[20%] left-[30%]">
                  <div class="bg-white px-2 py-1 rounded shadow text-xs font-medium text-brand-black">
                    Oceanside
                  </div>
                </div>
                
                <!-- Vista - Top Right -->
                <div class="absolute top-[25%] right-[25%]">
                  <div class="bg-white px-2 py-1 rounded shadow text-xs font-medium text-brand-black">
                    Vista
                  </div>
                </div>
                
                <!-- San Marcos - Right -->
                <div class="absolute top-[45%] right-[15%]">
                  <div class="bg-white px-2 py-1 rounded shadow text-xs font-medium text-brand-black">
                    San Marcos
                  </div>
                </div>
                
                <!-- Encinitas - Bottom -->
                <div class="absolute bottom-[25%] left-[35%]">
                  <div class="bg-white px-2 py-1 rounded shadow text-xs font-medium text-brand-black">
                    Encinitas
                  </div>
                </div>
                
                <!-- Solana Beach - Bottom Left -->
                <div class="absolute bottom-[15%] left-[20%]">
                  <div class="bg-white px-2 py-1 rounded shadow text-xs font-medium text-brand-gray">
                    Solana Beach
                  </div>
                </div>
                
                <!-- Rancho Santa Fe - Bottom Right -->
                <div class="absolute bottom-[20%] right-[20%]">
                  <div class="bg-white px-2 py-1 rounded shadow text-xs font-medium text-brand-gray">
                    Rancho Santa Fe
                  </div>
                </div>
              </div>
              
              <!-- Response time badge -->
              <div class="absolute bottom-4 left-4 right-4 bg-white/90 backdrop-blur-sm rounded-xl p-4 shadow-card">
                <div class="flex items-center justify-between">
                  <div class="flex items-center gap-3">
                    <div class="w-10 h-10 rounded-full bg-brand-orange-100 flex items-center justify-center">
                      <Icon name="lightning" size="md" class="text-brand-orange" />
                    </div>
                    <div>
                      <p class="font-semibold text-brand-black">60-Minute Response</p>
                      <p class="text-body-sm text-brand-gray">Throughout our service area</p>
                    </div>
                  </div>
                  <div class="text-right">
                    <p class="text-body-sm text-brand-gray">Available</p>
                    <p class="font-bold text-brand-orange">24/7</p>
                  </div>
                </div>
              </div>
            </div>
          </div>
        )}
      </div>
    )}
  </div>
</section>
