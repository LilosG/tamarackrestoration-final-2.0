---
/**
 * BaseLayout Component
 * ====================
 * Main layout wrapper for all pages
 */

import '@/styles/global.css';
import SEOHead from '@/components/seo/SEOHead.astro';
import Header from '@/components/global/Header.astro';
import Footer from '@/components/global/Footer.astro';
import type { SEOProps } from '@/types';
import { business } from '@/data/site';
import { getLocalBusinessSchema } from '@/utils/seo';

interface Props extends SEOProps {
  class?: string;
}

const { 
  title, 
  description, 
  canonical,
  noindex = false,
  nofollow = false,
  ogType = 'website',
  ogImage,
  twitterCard = 'summary_large_image',
  jsonLd,
  class: className 
} = Astro.props;

// Always include LocalBusiness schema
const baseSchema = getLocalBusinessSchema();
const allSchemas = jsonLd 
  ? [baseSchema, ...(Array.isArray(jsonLd) ? jsonLd : [jsonLd])]
  : [baseSchema];
---

<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    
    <!-- Preconnect to external resources -->
    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    
    <!-- Fonts -->
    <link 
      href="https://fonts.googleapis.com/css2?family=Archivo+Black&family=Archivo:wght@400;500;600;700&family=Source+Sans+3:wght@400;500;600;700&display=swap" 
      rel="stylesheet"
    />
    
    <!-- Favicon -->
    <link rel="icon" type="image/svg+xml" href="/favicon.svg" />
    <link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png" />
    <link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png" />
    <link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png" />
    <link rel="manifest" href="/site.webmanifest" />
    
    <!-- SEO -->
    <SEOHead
      title={title}
      description={description}
      canonical={canonical}
      noindex={noindex}
      nofollow={nofollow}
      ogType={ogType}
      ogImage={ogImage}
      twitterCard={twitterCard}
      jsonLd={allSchemas}
    />
    
    <!-- Generator -->
    <meta name="generator" content={Astro.generator} />
  </head>
  
  <body class:list={['min-h-screen flex flex-col', className]}>
    <!-- Skip Link for Accessibility -->
    <a href="#main-content" class="skip-link">
      Skip to main content
    </a>
    
    <!-- Header -->
    <Header />
    
    <!-- Main Content -->
    <main id="main-content" class="flex-1">
      <slot />
    </main>
    
    <!-- Footer -->
    <Footer />
    
    <!-- Mobile Sticky CTA -->
    <div class="fixed bottom-0 left-0 right-0 z-sticky lg:hidden bg-white border-t border-brand-cream-300 p-3 shadow-soft-lg">
      <div class="flex items-center gap-3">
        <a 
          href={`tel:${business.phone}`}
          class="flex-1 flex items-center justify-center gap-2 bg-brand-orange text-white font-semibold py-3 rounded-lg hover:bg-brand-orange-600 transition-colors"
        >
          <svg class="w-5 h-5" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <path d="M22 16.92v3a2 2 0 0 1-2.18 2 19.79 19.79 0 0 1-8.63-3.07 19.5 19.5 0 0 1-6-6 19.79 19.79 0 0 1-3.07-8.67A2 2 0 0 1 4.11 2h3a2 2 0 0 1 2 1.72 12.84 12.84 0 0 0 .7 2.81 2 2 0 0 1-.45 2.11L8.09 9.91a16 16 0 0 0 6 6l1.27-1.27a2 2 0 0 1 2.11-.45 12.84 12.84 0 0 0 2.81.7A2 2 0 0 1 22 16.92z"/>
          </svg>
          Call Now
        </a>
        <a 
          href="/contact/"
          class="flex-1 flex items-center justify-center gap-2 bg-brand-black text-white font-semibold py-3 rounded-lg hover:bg-brand-black-900 transition-colors"
        >
          Get Help
        </a>
      </div>
    </div>
    
    <!-- Add padding to body to account for sticky CTA on mobile -->
    <div class="h-20 lg:hidden" aria-hidden="true"></div>
  </body>
</html>
