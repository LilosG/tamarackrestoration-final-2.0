---
/**
 * About Section Layout
 * ====================
 * Unified layout for all /about/ pages
 * Uses Hero component for consistent styling
 */

import BaseLayout from './BaseLayout.astro';
import Hero from '@/components/sections/Hero.astro';
import TrustBar from '@/components/sections/TrustBar.astro';
import Icon from '@/components/ui/Icon.astro';
import Button from '@/components/ui/Button.astro';
import { business } from '@/data/site';
import { aboutPages } from '@/data/about';
import type { AboutPageKey } from '@/data/about';
import { getCanonicalUrl, getBreadcrumbSchema } from '@/utils/seo';

interface Props {
  page: AboutPageKey;
}

const { page } = Astro.props;
const config = aboutPages[page];

const canonical = getCanonicalUrl(page === 'index' ? '/about/' : `/about/${config.slug}/`);
const breadcrumbs = page === 'index' 
  ? [{ label: 'Home', href: '/' }, { label: 'About', href: '/about/' }]
  : [{ label: 'Home', href: '/' }, { label: 'About', href: '/about/' }, { label: config.heroTitle + (config.heroAccent ? ' ' + config.heroAccent : ''), href: `/about/${config.slug}/` }];
const breadcrumbSchema = getBreadcrumbSchema(breadcrumbs);

const ctaTitle = config.ctaTitle || 'Ready to Experience the Tamarack Difference?';
const ctaSubtitle = config.ctaSubtitle || '24/7 emergency service with 60-minute response time throughout North San Diego County.';
const phoneHref = `tel:${business.phone}`;

// Build hero title with accent
const heroTitle = config.heroAccent 
  ? `${config.heroTitle} ` 
  : config.heroTitle;
---

<BaseLayout title={config.title} description={config.description} canonical={canonical} jsonLd={[breadcrumbSchema]}>
  
  <Hero 
    title={config.heroTitle}
    titleAccent={config.heroAccent}
    subtitle={config.heroSubtitle}
    showForm={false}
    backgroundImage="/images/team/team-thumbs-up.webp"
    variant="about"
  />
  
  {config.showTrustBar && <TrustBar variant="light" />}
  
  <slot />
  
  <!-- CTA -->
  <section class="section bg-brand-black">
    <div class="container">
      <div class="max-w-3xl mx-auto text-center">
        <h2 class="font-heading text-3xl md:text-4xl font-bold text-white mb-6">{ctaTitle}</h2>
        <p class="text-brand-cream-300 text-lg mb-8">{ctaSubtitle}</p>
        <div class="flex flex-col sm:flex-row gap-4 justify-center">
          <Button href={phoneHref} variant="primary" size="lg">
            <Icon name="phone" size="sm" />
            Call {business.phoneFormatted}
          </Button>
          <Button href="/contact/" variant="outline" size="lg" class="border-white text-white hover:bg-white hover:text-brand-black">
            {page === 'faq' ? 'Send Us a Message' : 'Contact Us'}
            <Icon name="arrow-right" size="sm" />
          </Button>
        </div>
      </div>
    </div>
  </section>
</BaseLayout>
